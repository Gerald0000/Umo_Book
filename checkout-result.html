<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Status</title>
</head>

<body>
    <h1 id="message"></h1>
    <script>
        // Get query parameters from the URL
        const urlParams = new URLSearchParams(window.location.search);
        const status = urlParams.get('status');
        const messageElement = document.getElementById('message');

        // Function to trigger download
        function downloadFile(url) {
            const anchor = document.createElement('a');
            anchor.href = url;
            anchor.download = ''; // Suggest download behavior
            document.body.appendChild(anchor);
            anchor.click();
            document.body.removeChild(anchor);
        }

        // Handle based on the status
        if (status === 'successful') {
            messageElement.textContent = 'Payment successful! Downloading book... Please wait, do not leave this page.';
            setTimeout(() => {
                downloadFile('https://mega.nz/file/AsgWVAhQ#isXGprskZbLP4KnLNuNHcbI279s6FnLcsj8Vydm_sio');
            }, 2000); // Slight delay to show message before download
        } else if (status === 'cancelled') {
            messageElement.textContent = 'Payment cancelled! Redirecting to the home page...';
            setTimeout(() => {
                window.location.href = '/checkout.html';
            }, 3000); // Wait 3 seconds before redirecting
        } else {
            messageElement.textContent = 'Payment failed or an unknown error occurred. Redirecting to the home page...';
            setTimeout(() => {
                window.location.href = '/checkout.html';
            }, 3000); // Wait 3 seconds before redirecting
        }
    </script>
</body>

</html>
